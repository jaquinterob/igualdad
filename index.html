<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juntos a la Par: Igualdad y Unidad en el Matrimonio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Chosen Palette: Certificate Achievement (White, Gold, Deep Blue, Dark Grey) -->
    <!-- Application Structure Plan: The SPA is designed as a single-page scrolling journey. It starts with a Hero section stating the core principle. It then moves to "The Divine Ideal" to establish the 'why'. Next, the "Challenge of Inequality" section uses interactive charts to present the 'what' (the problems). "Fostering Equality" provides the 'how' through interactive tabs with practical principles. The centerpiece is the "Interactive Self-Assessment", turning the static quiz into a dynamic tool for self-reflection. It concludes with an "Action Plan" section for personal commitment. This structure guides the user from understanding to application in a logical, engaging flow. -->
    <!-- Visualization & Content Choices: 
        - Report Info: Data on marriage problems. Goal: Compare key obstacles. Viz: Horizontal Bar Chart (Chart.js). Interaction: Tooltips on hover. Justification: Bar charts are excellent for comparing categorical data percentages clearly. Library: Chart.js.
        - Report Info: Data on strengths of happy marriages. Goal: Compare key strengths. Viz: Horizontal Bar Chart (Chart.js). Interaction: Tooltips on hover. Justification: Complements the obstacles chart, showing the positive side. Library: Chart.js.
        - Report Info: Principles for equality. Goal: Organize dense text. Viz: Tabbed Interface (HTML/CSS/JS). Interaction: Clicking tabs reveals content. Justification: Prevents a "wall of text" and allows users to focus on one principle at a time. Method: Vanilla JS.
        - Report Info: Equality in Marriage Quiz. Goal: Create an engaging self-assessment. Viz: Interactive form with a summary Radar Chart (Chart.js). Interaction: Users click radio buttons, scores are calculated, and a chart is generated on demand. Justification: Turns a passive quiz into an active, insightful tool, a key "wow" factor. Library: Chart.js.
        - NEW LLM Feature: Report Info: Principles for equality. Goal: Generate actionable exercises based on principles. Viz: Text output in a dedicated area. Interaction: Button click triggers LLM call; provides loading feedback. Justification: Enhances practical application and engagement. Library: Gemini API (gemini-2.0-flash).
        - NEW Feature: Commitment Display. Goal: Visually highlight user's personal commitment. Viz: Large, styled text block. Interaction: Button click reveals and populates the block. Justification: Provides a dramatic and memorable presentation of the user's chosen action plan. Method: HTML/CSS (Tailwind)/JS.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF8; /* Warm off-white */
            color: #4A4A4A;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        @media (max-width: 640px) {
            .chart-container {
                height: 400px;
            }
        }
        .nav-button-active {
            background-color: #C08497; /* Dusty Rose */
            color: #FFFFFF;
        }
        .nav-button-inactive {
            background-color: #F1D4D4; /* Light Pink/Beige */
            color: #C08497;
        }
        .accent-bg { background-color: #C08497; }
        .accent-text { color: #C08497; }
        .secondary-bg { background-color: #F1D4D4; }
        .secondary-text { color: #8D5A68; }
        blockquote {
            border-left: 4px solid #F1D4D4;
        }
        .assessment-radio:checked + label {
            background-color: #C08497;
            color: white;
            border-color: #C08497;
        }
        .assessment-radio:hover + label {
            background-color: #f1d4d4;
        }
        .llm-loading {
            display: inline-block;
            border: 4px solid #f3f3f3;
            border-radius: 50%;
            border-top: 4px solid #C08497;
            width: 20px;
            height: 20px;
            -webkit-animation: spin 2s linear infinite; /* Safari */
            animation: spin 2s linear infinite;
        }

        /* Safari */
        @-webkit-keyframes spin {
            0% { -webkit-transform: rotate(0deg); }
            100% { -webkit-transform: rotate(360deg); }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .message-box {
            background-color: #ffe0b2; /* Light orange for warnings */
            color: #e65100; /* Darker orange text */
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
            text-align: center;
        }
        .error-message-llm {
            background-color: #fce2e2; /* Light red for errors */
            color: #cc0000; /* Darker red text */
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
            text-align: center;
        }
        /* Majestic Commitment Box Styling (Certificate/Diploma look) */
        .majestic-commitment-box {
            background-color: #FFFFFF; /* Pure white for certificate paper look */
            color: #333333; /* Dark text for readability */
            border: 5px solid #D4AF37; /* Gold border for certificate feel */
            border-radius: 1.5rem; /* Soft rounded corners */
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.25), 0 5px 15px rgba(0, 0, 0, 0.1); /* Stronger, elegant shadow */
            padding: 3rem;
            text-align: center;
            margin-top: 4rem;
            transition: all 0.7s cubic-bezier(0.25, 0.8, 0.25, 1); /* Smoother, more pronounced transition */
            transform: scale(0.8); /* Start smaller */
            opacity: 0; /* Start hidden */
            position: relative;
            overflow: hidden; /* For pseudo-elements */
            display: flex; /* Flexbox for centering content inside */
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 250px; /* Ensure a minimum height */
        }
        /* Sparkling effects for the certificate */
        .majestic-commitment-box::before {
            content: '‚ú®';
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 3rem; /* Larger sparkle */
            opacity: 0.7;
            z-index: 1;
            color: #FFD700; /* Gold color for sparkles */
        }
        .majestic-commitment-box::after {
            content: 'üåü';
            position: absolute;
            bottom: 10px;
            left: 10px;
            font-size: 3rem; /* Larger sparkle */
            opacity: 0.7;
            z-index: 1;
            color: #FFD700; /* Gold color for sparkles */
        }
        .majestic-commitment-box.visible {
            transform: scale(1);
            opacity: 1;
        }
        /* Adjusted H3 for labels */
        .majestic-commitment-box h3 {
            color: #1A2B40; /* Deep Blue for labels, formal */
            font-size: 1.75rem; /* Smaller than main content */
            font-weight: 700; /* Bold enough to be clear */
            margin-bottom: 0.5rem; /* Reduce space below labels */
            text-shadow: none; /* No shadow for labels */
        }
        /* Prominent P for actual commitment text */
        .majestic-commitment-box p {
            font-size: 2.5rem; /* Significantly larger */
            font-weight: 800; /* Extra bold */
            line-height: 1.3;
            margin-bottom: 2rem; /* More space below commitment */
            text-shadow: 1px 1px 3px rgba(0,0,0,0.15); /* A bit more text shadow for pop */
            position: relative; /* For potential emojis inside p */
            padding: 0.5rem 1rem; /* Padding for the text */
            border-radius: 0.5rem;
            /* No background color for content to keep clean certificate look */
            background-color: transparent; 
        }
        .majestic-commitment-box #displayPrinciple {
            color: #4A5568; /* Dark slate grey for principle */
            font-style: italic; /* Add italic for a touch of elegance */
        }
        .majestic-commitment-box #displayActionStep {
            color: #B8860B; /* Dark Goldenrod for action, strong contrast */
            font-weight: 900; /* Even bolder for action */
        }
        /* No emojis in the commitment text */
        .majestic-commitment-box #displayPrinciple::before,
        .majestic-commitment-box #displayPrinciple::after,
        .majestic-commitment-box #displayActionStep::before,
        .majestic-commitment-box #displayActionStep::after {
            content: ''; 
        }

        @media (max-width: 768px) {
            .majestic-commitment-box {
                padding: 1.5rem; /* Adjusted padding for mobile */
            }
            .majestic-commitment-box h3 {
                font-size: 1.5rem;
                margin-bottom: 0.25rem;
            }
            .majestic-commitment-box p {
                font-size: 1.75rem; /* Adjusted text size for mobile */
                margin-bottom: 1.5rem;
            }
            .majestic-commitment-box::before,
            .majestic-commitment-box::after {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body class="antialiased">

    <header class="py-12 bg-white shadow-sm">
        <div class="max-w-4xl mx-auto text-center px-4">
            <h1 class="text-4xl md:text-5xl font-bold accent-text">Juntos a la Par</h1>
            <p class="mt-4 text-xl text-gray-600">Cultivando la Igualdad y la Unidad en el Matrimonio</p>
        </div>
    </header>

    <main class="py-16">
        <div class="max-w-4xl mx-auto space-y-20 px-4">

            <!-- API Key Warning Message -->
            <div id="apiKeyWarning" class="message-box hidden">
                <p class="font-bold">¬°Atenci√≥n! Falta la clave de API de Gemini.</p>
                <p>Para que las actividades pr√°cticas funcionen, debes obtener tu clave de API de Gemini en <a href="https://aistudio.google.com/app/apikey" target="_blank" class="underline">Google AI Studio</a> y pegarla en el c√≥digo donde dice <code class="font-mono">const apiKey = "TU_API_KEY_AQUI";</code>.</p>
            </div>

            <!-- Section 1: The Divine Ideal -->
            <section id="ideal">
                <div class="text-center">
                    <h2 class="text-3xl font-bold mb-4">El Ideal Divino de la Uni√≥n</h2>
                    <p class="max-w-3xl mx-auto text-lg text-gray-700">
                        Esta secci√≥n explora la <span class="font-bold">base doctrinal y espiritual</span> de por qu√© la igualdad y la unidad son fundamentales en el plan del Se√±or para el matrimonio. A trav√©s de las palabras de los profetas, entenderemos la <span class="font-bold">visi√≥n sagrada</span> de dos personas que caminan juntas como compa√±eros iguales en una jornada eterna.
                    </p>
                </div>
                <div class="mt-12 grid md:grid-cols-2 gap-8">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <blockquote class="pl-4 py-2 mb-4">
                            <p class="text-lg italic">"No debe existir la inferioridad ni la superioridad entre esposo y esposa dentro del plan del se√±or."</p>
                        </blockquote>
                        <p class="text-right font-medium secondary-text">- Presidente Gordon B. Hinckley</p>
                    </div>
                     <div class="bg-white p-6 rounded-lg shadow-md">
                        <blockquote class="pl-4 py-2 mb-4">
                            <p class="text-lg italic">"Cuando el hombre y la mujer fueron creados, ¬°la uni√≥n matrimonial no les fue dada como esperanza, sino como mandamiento!"</p>
                        </blockquote>
                        <p class="text-right font-medium secondary-text">- √âlder Henry B. Eyring</p>
                    </div>
                     <div class="bg-white p-6 rounded-lg shadow-md">
                        <blockquote class="pl-4 py-2 mb-4">
                            <p class="text-lg italic">"El hombre que posee el sacerdocio debe aceptar a su esposa como compa√±era en la direcci√≥n del hogar y de la familia..."</p>
                        </blockquote>
                        <p class="text-right font-medium secondary-text">- Presidente Howard W. Hunter</p>
                    </div>
                     <div class="bg-white p-6 rounded-lg shadow-md">
                        <blockquote class="pl-4 py-2 mb-4">
                            <p class="text-lg italic">"Ni el hombre ni la mujer son perfectos o completos sin el otro... trabajen juntos en unidad de prop√≥sito..."</p>
                        </blockquote>
                        <p class="text-right font-medium secondary-text">- Hermana Sheri L. Dew</p>
                    </div>
                </div>
            </section>

            <!-- Section 2: The Challenge of Inequality -->
            <section id="desafio">
                <div class="text-center">
                    <h2 class="text-3xl font-bold mb-4">El Desaf√≠o de la Desigualdad: Datos y Realidades</h2>
                     <p class="max-w-3xl mx-auto text-lg text-gray-700">
                        Los datos revelan <span class="font-bold">patrones claros</span> sobre lo que fortalece o debilita un matrimonio. En esta secci√≥n interactiva, visualizaremos los resultados de estudios con miles de parejas. Explora los gr√°ficos para ver cu√°les son los <span class="font-bold">obst√°culos m√°s comunes</span> para la felicidad conyugal y, en contraste, cu√°les son las <span class="font-bold">fortalezas clave</span> de los matrimonios felices.
                    </p>
                </div>
                <div class="mt-12 grid lg:grid-cols-2 gap-16">
                    <div>
                        <h3 class="text-xl font-semibold text-center mb-4">Principales Obst√°culos para la Felicidad Matrimonial</h3>
                        <div class="chart-container h-96 md:h-[450px]">
                            <canvas id="obstaclesChart"></canvas>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-xl font-semibold text-center mb-4">Principales Fortalezas de los Matrimonios Felices</h3>
                         <div class="chart-container h-96 md:h-[450px]">
                            <canvas id="strengthsChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 3: Fostering Equality -->
            <section id="principios">
                <div class="text-center">
                    <h2 class="text-3xl font-bold mb-4">Fomentando la Igualdad: Principios Pr√°cticos</h2>
                    <p class="max-w-3xl mx-auto text-lg text-gray-700">
                        Lograr la unidad es un <span class="font-bold">proceso activo</span>. Esta secci√≥n presenta <span class="font-bold">principios clave</span> que pueden transformar su relaci√≥n. Navega por las pesta√±as para descubrir consejos pr√°cticos y ense√±anzas inspiradoras sobre c√≥mo amarse, respetarse, tomar decisiones juntos y superar la tendencia a dominar.
                    </p>
                </div>
                <div class="mt-12">
                    <div class="mb-4 flex flex-wrap justify-center gap-2">
                        <button onclick="changeTab(0)" class="nav-button nav-button-active px-4 py-2 font-semibold rounded-lg transition">Amor y Respeto</button>
                        <button onclick="changeTab(1)" class="nav-button nav-button-inactive px-4 py-2 font-semibold rounded-lg transition">Presidir con Rectitud</button>
                        <button onclick="changeTab(2)" class="nav-button nav-button-inactive px-4 py-2 font-semibold rounded-lg transition">Evitar el Dominio</button>
                        <button onclick="changeTab(3)" class="nav-button nav-button-inactive px-4 py-2 font-semibold rounded-lg transition">Decidir de Com√∫n Acuerdo</button>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <div class="tab-content">
                            <h3 class="text-2xl font-bold mb-3 accent-text">Amarse y respetarse mutuamente como compa√±eros iguales</h3>
                            <p class="text-gray-700 mb-4">El presidente Hinckley ense√±√≥ que debemos andar <span class="font-bold">"uno al lado del otro, con respeto, aprecio y amor el uno por el otro"</span>. El <span class="font-bold">altruismo total</span> es un nutriente esencial para el amor. Si se buscan constantemente los intereses, la comodidad y la felicidad del c√≥nyuge, el amor crecer√° en dimensiones inconmensurables.</p>
                            <p class="text-gray-700"><span class="font-semibold">Nutrientes para el amor:</span> consideraci√≥n, amabilidad, cortes√≠a, preocupaci√≥n, expresiones de afecto, admiraci√≥n, confianza, fe, esfuerzo mutuo, igualdad e interdependencia.</p>
                            <button class="generate-exercise-btn mt-4 bg-rose-500 hover:bg-rose-600 text-white font-bold py-2 px-4 rounded-lg transition shadow-md flex items-center justify-center gap-2">‚ú® Generar Actividad Pr√°ctica</button>
                            <div class="generated-exercise mt-4 p-4 bg-gray-50 rounded-md border border-gray-200 hidden">
                                <p class="font-semibold secondary-text">Actividad Sugerida:</p>
                                <p class="exercise-text text-gray-800 mt-2"></p>
                                <div class="llm-loading mt-2 hidden"></div>
                            </div>
                        </div>
                        <div class="tab-content hidden">
                            <h3 class="text-2xl font-bold mb-3 accent-text">Presidir con rectitud</h3>
                            <p class="text-gray-700 mb-4">Por designio divino, el padre preside con <span class="font-bold">amor y rectitud</span>. El √©lder L. Tom Perry explic√≥ que esto implica una <span class="font-bold">total unidad e igualdad</span>: "En la familia no hay presidente ni vicepresidenta. Ambos c√≥nyuges trabajan juntos eternamente por el bien de la familia... Se encuentran en igualdad de condiciones". Las relaciones deben guiarse por la <span class="font-bold">persuasi√≥n, longanimidad, mansedumbre, amor y bondad</span> (D. y C. 121:41‚Äì42).</p>
                             <button class="generate-exercise-btn mt-4 bg-rose-500 hover:bg-rose-600 text-white font-bold py-2 px-4 rounded-lg transition shadow-md flex items-center justify-center gap-2">‚ú® Generar Actividad Pr√°ctica</button>
                            <div class="generated-exercise mt-4 p-4 bg-gray-50 rounded-md border border-gray-200 hidden">
                                <p class="font-semibold secondary-text">Actividad Sugerida:</p>
                                <p class="exercise-text text-gray-800 mt-2"></p>
                                <div class="llm-loading mt-2 hidden"></div>
                            </div>
                        </div>
                        <div class="tab-content hidden">
                            <h3 class="text-2xl font-bold mb-3 accent-text">Reconocer y cambiar la tendencia a dominar</h3>
                            <p class="text-gray-700 mb-4">La naturaleza de casi todos los hombres (y mujeres) es comenzar a ejercer <span class="font-bold">injusto dominio</span> al recibir un poco de autoridad. Esto puede manifestarse al controlar decisiones, dinero o la disciplina de los hijos sin la participaci√≥n del c√≥nyuge. Para cambiar, debemos <span class="font-bold">cuestionar los pensamientos</span> que sustentan esta conducta. Por ejemplo, en lugar de pensar "Si quiero que se haga bien, lo hago yo", podemos aprender a confiar y colaborar, reconociendo que los temores pueden ser exagerados.</p>
                             <button class="generate-exercise-btn mt-4 bg-rose-500 hover:bg-rose-600 text-white font-bold py-2 px-4 rounded-lg transition shadow-md flex items-center justify-center gap-2">‚ú® Generar Actividad Pr√°ctica</button>
                            <div class="generated-exercise mt-4 p-4 bg-gray-50 rounded-md border border-gray-200 hidden">
                                <p class="font-semibold secondary-text">Actividad Sugerida:</p>
                                <p class="exercise-text text-gray-800 mt-2"></p>
                                <div class="llm-loading mt-2 hidden"></div>
                            </div>
                        </div>
                        <div class="tab-content hidden">
                            <h3 class="text-2xl font-bold mb-3 accent-text">Tomen las decisiones de com√∫n acuerdo</h3>
                            <p class="text-gray-700 mb-4">En un matrimonio s√≥lido, las <span class="font-bold">decisiones importantes</span> que afectan a la familia se toman juntos. Esto requiere dejar de pensar solo en las necesidades personales y considerar el <span class="font-bold">bienestar del grupo familiar</span>. Cuando los c√≥nyuges deliberan juntos con la ayuda del Esp√≠ritu Santo, la confianza crece y las decisiones son m√°s sabias. El Esp√≠ritu de Dios nunca causa contenci√≥n; une y unifica en prop√≥sito y acci√≥n.</p>
                             <button class="generate-exercise-btn mt-4 bg-rose-500 hover:bg-rose-600 text-white font-bold py-2 px-4 rounded-lg transition shadow-md flex items-center justify-center gap-2">‚ú® Generar Actividad Pr√°ctica</button>
                            <div class="generated-exercise mt-4 p-4 bg-gray-50 rounded-md border border-gray-200 hidden">
                                <p class="font-semibold secondary-text">Actividad Sugerida:</p>
                                <p class="exercise-text text-gray-800 mt-2"></p>
                                <div class="llm-loading mt-2 hidden"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Section 4: Self-Assessment -->
            <section id="autoevaluacion">
                 <div class="text-center">
                    <h2 class="text-3xl font-bold mb-4">Autoevaluaci√≥n Interactiva de la Relaci√≥n</h2>
                    <p class="max-w-3xl mx-auto text-lg text-gray-700">
                       La <span class="font-bold">reflexi√≥n honesta</span> es el primer paso hacia el crecimiento. Utiliza esta herramienta para evaluar diferentes aspectos de la igualdad en tu matrimonio. Responde desde tu perspectiva y luego considera c√≥mo crees que tu c√≥nyuge te calificar√≠a. Al final, podr√°s generar un <span class="font-bold">resumen visual</span> que te ayudar√° a identificar fortalezas y √°reas de oportunidad para conversar en pareja.
                    </p>
                </div>
                <div class="mt-12 bg-white p-6 md:p-8 rounded-lg shadow-lg">
                    <form id="assessmentForm">
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm md:text-base">
                                <thead>
                                    <tr class="border-b">
                                        <th class="py-3 px-2 text-left font-semibold">Aspecto de la relaci√≥n</th>
                                        <th class="py-3 px-2 text-center font-semibold">Mis Puntos (1-5)</th>
                                        <th class="py-3 px-2 text-center font-semibold">Puntos que creo me dar√≠a mi c√≥nyuge (1-5)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                         <div id="assessmentMessage" class="message-box hidden mt-4">
                            Por favor, responde todas las preguntas antes de ver el resumen.
                        </div>
                         <div class="mt-8 text-center">
                            <button type="button" id="showResultsBtn" class="bg-rose-500 hover:bg-rose-600 text-white font-bold py-3 px-6 rounded-lg transition shadow-md accent-bg">Mostrar Mi Resumen Visual</button>
                        </div>
                    </form>
                    <div id="resultsContainer" class="hidden mt-8">
                        <h3 class="text-xl font-semibold text-center mb-4">Resumen de mi Percepci√≥n vs. Percepci√≥n de mi C√≥nyuge</h3>
                        <div class="chart-container h-80 md:h-96 lg:h-[500px]">
                            <canvas id="resultsChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 5: Action Plan -->
            <section id="plan">
                <div class="text-center">
                    <h2 class="text-3xl font-bold mb-4">Nuestro Plan de Acci√≥n</h2>
                    <p class="max-w-3xl mx-auto text-lg text-gray-700">
                        El <span class="font-bold">cambio duradero</span> nace de la intenci√≥n y el compromiso. Despu√©s de reflexionar, es hora de actuar. Utiliza este espacio para formular un <span class="font-bold">plan espec√≠fico</span> con tu pareja. Elijan un principio en el que quieran enfocarse y definan pasos concretos para ponerlo en pr√°ctica.
                    </p>
                </div>
                <div class="mt-12 bg-white p-8 rounded-lg shadow-lg max-w-2xl mx-auto">
                    <h3 class="font-bold text-xl accent-text">Mi Compromiso de Unidad</h3>
                    <div class="mt-4">
                        <label for="principle" class="block mb-2 font-semibold text-gray-700">El principio que elegimos fortalecer es:</label>
                        <input type="text" id="principle" class="w-full p-2 border rounded-md focus:ring-2 focus:ring-rose-300 focus:border-rose-300" placeholder="Ej: Tomar decisiones de com√∫n acuerdo">
                    </div>
                    <div class="mt-4">
                        <label for="action_step" class="block mb-2 font-semibold text-gray-700">Nuestra acci√≥n concreta ser√°:</label>
                        <textarea id="action_step" rows="4" class="w-full p-2 border rounded-md focus:ring-2 focus:ring-300 focus:border-rose-300" placeholder="Ej: Planificar juntos los gastos de la semana."></textarea>
                    </div>
                     <div class="mt-6 text-center">
                        <p class="text-gray-600 italic">"El dedicar tiempo y energ√≠as para fomentar la unidad y la igualdad, brindar√° nueva vitalidad a su matrimonio."</p>
                        <button type="button" id="showCommitmentBtn" class="mt-6 bg-rose-500 hover:bg-rose-600 text-white font-bold py-3 px-6 rounded-lg transition shadow-md accent-bg">üåü ¬°Ver Nuestro Compromiso!</button>
                    </div>
                </div>
                <!-- Majestic Commitment Display -->
                <div id="majesticCommitment" class="majestic-commitment-box mx-auto max-w-xl hidden">
                    <h3 class="font-extrabold mb-4">Nuestra Meta:</h3>
                    <p id="displayPrinciple" class="font-bold mb-6"></p>
                    <h3 class="font-extrabold mb-4">Nuestro Compromiso de Acci√≥n:</h3>
                    <p id="displayActionStep" class="font-bold"></p>
                </div>
            </section>

        </div>
    </main>

    <footer class="bg-gray-800 text-white py-8">
        <div class="max-w-4xl mx-auto text-center px-4">
            <p class="text-sm text-gray-400">&copy; 2025 Juntos a la Par. Inspirado en el manual "Fortaleciendo el Matrimonio".</p>
            <p class="text-xs text-gray-500 mt-1">Facilitadores John y Xiomara</p>
        </div>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', function () {
        
        const tabs = document.querySelectorAll('.tab-content');
        const navButtons = document.querySelectorAll('.nav-button');

        window.changeTab = function(tabIndex) {
            tabs.forEach((tab, index) => {
                if (index === tabIndex) {
                    tab.classList.remove('hidden');
                } else {
                    tab.classList.add('hidden');
                }
            });
            navButtons.forEach((button, index) => {
                if (index === tabIndex) {
                    button.classList.replace('nav-button-inactive', 'nav-button-active');
                } else {
                    button.classList.replace('nav-button-active', 'nav-button-inactive');
                }
            });
        };

        const obstaclesData = {
            labels: [
                'Compartir el liderazgo es problem√°tico', 
                'Mi c√≥nyuge es demasiado negativo(a) o cr√≠tico(a)', 
                'Siempre termino sinti√©ndome responsable del problema', 
                'Nunca terminamos de resolver nuestras diferencias'
            ],
            datasets: [{
                label: '% de parejas que coinciden',
                data: [93, 83, 81, 78],
                backgroundColor: 'rgba(192, 132, 151, 0.6)',
                borderColor: 'rgba(192, 132, 151, 1)',
                borderWidth: 1
            }]
        };

        const strengthsData = {
            labels: [
                'Estamos de acuerdo en c√≥mo usar el dinero',
                'Somos creativos al hacer frente a nuestras diferencias',
                'Mi c√≥nyuge casi nunca es mand√≥n(a)'
            ],
            datasets: [{
                label: '% de matrimonios felices que coinciden',
                data: [89, 78, 78],
                backgroundColor: 'rgba(112, 159, 176, 0.6)',
                borderColor: 'rgba(112, 159, 176, 1)',
                borderWidth: 1
            }]
        };
        
        const chartOptions = {
            indexAxis: 'y',
            maintainAspectRatio: false,
            scales: {
                x: {
                    beginAtZero: true,
                    max: 100,
                    ticks: {
                        callback: function(value) {
                            return value + '%'
                        }
                    }
                },
                y: {
                   ticks: {
                        autoSkip: false,
                        callback: function(value) {
                            const label = this.getLabelForValue(value);
                            if (label.length > 25) {
                                return label.match(/.{1,25}/g);
                            }
                            return label;
                        }
                   }
                }
            },
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return `${context.dataset.label}: ${context.raw}%`;
                        }
                    }
                }
            }
        };

        new Chart(document.getElementById('obstaclesChart'), {
            type: 'bar',
            data: obstaclesData,
            options: chartOptions
        });

        new Chart(document.getElementById('strengthsChart'), {
            type: 'bar',
            data: strengthsData,
            options: chartOptions
        });
        
        const assessmentQuestions = [
            "Gu√≠o a mi familia de acuerdo con las pautas de las Escrituras.",
            "Soy cari√±oso con mi c√≥nyuge e hijos y ellos sienten mi amor.",
            "Respeto a los integrantes de mi familia y no soy iracundo.",
            "Mi prioridad es tratar a mi c√≥nyuge con amor y bondad.",
            "Vivo de tal forma que mi c√≥nyuge desea estar conmigo eternamente.",
            "Trato a mi c√≥nyuge como un compa√±ero igual.",
            "Vivo de modo tal que invito la influencia del Esp√≠ritu a nuestro hogar.",
            "Intento solucionar los problemas por medio del consejo mutuo.",
            "Me esfuerzo por entender y respetar los sentimientos de mi c√≥nyuge.",
            "Respeto la necesidad de espacio y privacidad de mi c√≥nyuge.",
            "Decidimos, como compa√±eros iguales, c√≥mo usar el dinero.",
            "Compartimos las responsabilidades dom√©sticas.",
            "Ayudo a mi c√≥nyuge a desarrollar talentos y buscar intereses.",
            "Tenemos las mismas metas espirituales y compromiso con el Evangelio.",
            "Ambos impartimos disciplina a nuestros hijos.",
            "Ambos nos sentimos bien con la responsabilidad de presidir del esposo."
        ];

        const formBody = document.querySelector('#assessmentForm tbody');
        assessmentQuestions.forEach((question, index) => {
            const row = document.createElement('tr');
            row.className = 'border-b hover:bg-gray-50';
            let ratingHtml = '';
            for (let i = 1; i <= 5; i++) {
                ratingHtml += `
                    <input type="radio" id="q${index}-self-${i}" name="q${index}-self" value="${i}" class="hidden assessment-radio">
                    <label for="q${index}-self-${i}" class="cursor-pointer w-7 h-7 md:w-8 md:h-8 flex items-center justify-center border rounded-full transition">${i}</label>
                `;
            }
            let spouseRatingHtml = '';
            for (let i = 1; i <= 5; i++) {
                spouseRatingHtml += `
                    <input type="radio" id="q${index}-spouse-${i}" name="q${index}-spouse" value="${i}" class="hidden assessment-radio">
                    <label for="q${index}-spouse-${i}" class="cursor-pointer w-7 h-7 md:w-8 md:h-8 flex items-center justify-center border rounded-full transition">${i}</label>
                `;
            }
            row.innerHTML = `
                <td class="py-3 px-2">${question}</td>
                <td class="py-3 px-2"><div class="flex justify-center gap-1 md:gap-2">${ratingHtml}</div></td>
                <td class="py-3 px-2"><div class="flex justify-center gap-1 md:gap-2">${spouseRatingHtml}</div></td>
            `;
            formBody.appendChild(row);
        });

        let resultsChartInstance = null;
        document.getElementById('showResultsBtn').addEventListener('click', () => {
            const selfScores = [];
            const spouseScores = [];
            let allAnswered = true;
            for(let i=0; i < assessmentQuestions.length; i++) {
                const selfAnswer = document.querySelector(`input[name="q${i}-self"]:checked`);
                const spouseAnswer = document.querySelector(`input[name="q${i}-spouse"]:checked`);
                if (!selfAnswer || !spouseAnswer) {
                    allAnswered = false;
                    break;
                }
                selfScores.push(parseInt(selfAnswer.value));
                spouseScores.push(parseInt(spouseAnswer.value));
            }

            const assessmentMessage = document.getElementById('assessmentMessage');
            if (!allAnswered) {
                assessmentMessage.classList.remove('hidden');
                // Optional: Scroll to the message or the form to make it visible
                assessmentMessage.scrollIntoView({ behavior: 'smooth' });
                return;
            } else {
                assessmentMessage.classList.add('hidden');
            }
            
            document.getElementById('resultsContainer').classList.remove('hidden');
            
            const shortLabels = [
                'Gu√≠a', 'Afecto', 'Respeto', 'Prioridad', 'Eternidad', 'Igualdad',
                'Esp√≠ritu', 'Consejo', 'Entendimiento', 'Espacio', 'Dinero', 'Tareas',
                'Talentos', 'Metas Esp.', 'Disciplina', 'Presidir'
            ];

            const radarData = {
                labels: shortLabels,
                datasets: [
                    {
                        label: 'Mis Puntos',
                        data: selfScores,
                        fill: true,
                        backgroundColor: 'rgba(192, 132, 151, 0.2)',
                        borderColor: 'rgba(192, 132, 151, 1)',
                        pointBackgroundColor: 'rgba(192, 132, 151, 1)',
                    },
                    {
                        label: 'Como creo que me ve mi c√≥nyuge',
                        data: spouseScores,
                        fill: true,
                        backgroundColor: 'rgba(112, 159, 176, 0.2)',
                        borderColor: 'rgba(112, 159, 176, 1)',
                        pointBackgroundColor: 'rgba(112, 159, 176, 1)',
                    }
                ]
            };

            if (resultsChartInstance) {
                resultsChartInstance.destroy();
            }

            resultsChartInstance = new Chart(document.getElementById('resultsChart'), {
                type: 'radar',
                data: radarData,
                options: {
                    maintainAspectRatio: false,
                    elements: {
                        line: {
                            borderWidth: 3
                        }
                    },
                    scales: {
                        r: {
                            angleLines: {
                                display: false
                            },
                            suggestedMin: 0,
                            suggestedMax: 5,
                            pointLabels: {
                                font: {
                                    size: 10
                                }
                            },
                             ticks: {
                                stepSize: 1
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                title: function(context) {
                                    return assessmentQuestions[context[0].dataIndex];
                                }
                            }
                        }
                    }
                }
            });
            
            document.getElementById('resultsContainer').scrollIntoView({ behavior: 'smooth' });
        });

        const prompts = [
            "Genera una √∫nica idea de actividad pr√°ctica, muy corta y sencilla (una frase o punto claro) para una pareja casada (miembros de La Iglesia de Jesucristo de los Santos de los √öltimos D√≠as) sobre c√≥mo fortalecer el amor y el respeto mutuo. Aseg√∫rate de que la actividad no involucre caf√©, alcohol u otras sustancias prohibidas por la Palabra de Sabidur√≠a. Debe ser algo inspirador y que las parejas puedan hacer regularmente, no siempre religioso. Incluye un emoji alusivo. Conc√©ntrate solo en la acci√≥n inspiradora y hazla f√°cil de entender. Ej: 'Caminen juntos por el parque y compartan sus pensamientos. üå≥'",
            "Genera una √∫nica idea de actividad pr√°ctica, muy corta y sencilla (una frase o punto claro) para que un esposo presida con rectitud, promoviendo unidad e igualdad con su esposa (miembros de La Iglesia de Jesucristo de los Santos de los √öltimos D√≠as). Aseg√∫rate de que la actividad no involucre caf√©, alcohol u otras sustancias prohibidas por la Palabra de Sabidur√≠a. Debe ser algo inspirador y que las parejas puedan hacer regularmente, no siempre religioso. Incluye un emoji alusivo. Conc√©ntrate solo en la acci√≥n inspiradora y hazla f√°cil de entender. Ej: 'Planifiquen juntos una actividad de servicio para la comunidad. ü§ù'",
            "Genera una √∫nica idea de actividad pr√°ctica, muy corta y sencilla (una frase o punto claro) para que una pareja (miembros de La Iglesia de Jesucristo de los Santos de los √öltimos D√≠as) identifique y supere la tendencia a ejercer injusto dominio. Aseg√∫rate de que la actividad no involucre caf√©, alcohol u otras sustancias prohibidas por la Palabra de Sabidur√≠a. Debe ser algo inspirador y que las parejas puedan hacer regularmente, no siempre religioso. Incluye un emoji alusivo. Conc√©ntrate solo en la acci√≥n inspiradora y hazla f√°cil de entender. Ej: 'En una discusi√≥n, cada uno intente resumir la postura del otro antes de responder. üïäÔ∏è'",
            "Genera una √∫nica idea de actividad pr√°ctica, muy corta y sencilla (una frase o punto claro) para que una pareja (miembros de La Iglesia de Jesucristo de los Santos de los √öltimos D√≠as) practique la toma de decisiones de com√∫n acuerdo. Aseg√∫rate de que la actividad no involucre caf√©, alcohol u otras sustancias prohibidas por la Palabra de Sabidur√≠a. Debe ser algo inspirador y que las parejas puedan hacer regularmente, no siempre religioso. Incluye un emoji alusivo. Conc√©ntrate solo en la acci√≥n inspiradora y hazla f√°cil de entender. Ej: 'Planifiquen su pr√≥xima cita nocturna considerando las preferencias de ambos. ÔøΩ'"
        ];

        document.querySelectorAll('.generate-exercise-btn').forEach((button, index) => {
            button.addEventListener('click', async () => {
                const exerciseContainer = button.nextElementSibling;
                const exerciseTextElement = exerciseContainer.querySelector('.exercise-text');
                const loadingIndicator = exerciseContainer.querySelector('.llm-loading');
                const apiKeyWarning = document.getElementById('apiKeyWarning');

                // Check for API Key before making the call
                const apiKey = "AIzaSyDuNSd6su36eoFT7m2FzJWyqOvosqnopko"; // REEMPLAZA ESTO CON TU CLAVE DE API REAL DE GEMINI
                if (!apiKey || apiKey === "TU_API_KEY_AQUI" || apiKey.trim() === "") {
                    apiKeyWarning.classList.remove('hidden');
                    exerciseContainer.classList.add('hidden'); // Hide the exercise box if no key
                    exerciseTextElement.textContent = '';
                    loadingIndicator.classList.add('hidden');
                    apiKeyWarning.scrollIntoView({ behavior: 'smooth' });
                    return;
                } else {
                    apiKeyWarning.classList.add('hidden'); // Hide warning if key is present
                }

                exerciseContainer.classList.remove('hidden');
                exerciseTextElement.textContent = '';
                loadingIndicator.classList.remove('hidden');

                const prompt = prompts[index];
                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                const payload = { contents: chatHistory };
                // Using the provided apiKey directly
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`; 

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(`Error de la API: ${response.status} - ${errorData.error.message || 'Error desconocido'}`);
                    }
                    const result = await response.json();
                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        const text = result.candidates[0].content.parts[0].text;
                        exerciseTextElement.textContent = text.trim(); // Eliminar espacios en blanco extra
                    } else {
                        exerciseTextElement.textContent = "Lo siento, no pude generar una actividad. Intenta de nuevo.";
                    }
                } catch (error) {
                    console.error("Error al llamar a la API de Gemini:", error);
                    exerciseTextElement.textContent = `Hubo un error al generar la actividad: ${error.message}. Por favor, revisa tu conexi√≥n o intenta de nuevo m√°s tarde.`;
                } finally {
                    loadingIndicator.classList.add('hidden');
                }
            });
        });

        // New functionality for Majestic Commitment Display
        const showCommitmentBtn = document.getElementById('showCommitmentBtn');
        const majesticCommitment = document.getElementById('majesticCommitment');
        const displayPrinciple = document.getElementById('displayPrinciple');
        const displayActionStep = document.getElementById('displayActionStep');
        const principleInput = document.getElementById('principle');
        const actionStepInput = document.getElementById('action_step');

        showCommitmentBtn.addEventListener('click', () => {
            const principle = principleInput.value.trim();
            const action = actionStepInput.value.trim();

            if (principle === "" || action === "") {
                const messageBox = document.createElement('div');
                messageBox.className = 'message-box mt-4';
                messageBox.textContent = 'Por favor, completa tanto el principio como la acci√≥n antes de mostrar tu compromiso.';
                majesticCommitment.parentNode.insertBefore(messageBox, majesticCommitment);
                
                // Hide message after a few seconds
                setTimeout(() => {
                    messageBox.remove();
                }, 5000);
                majesticCommitment.classList.add('hidden'); // Ensure it's hidden if inputs are empty
                majesticCommitment.classList.remove('visible');
                return;
            }

            displayPrinciple.textContent = `"${principle}"`; // Added quotes without emojis
            displayActionStep.textContent = `"${action}"`; // Added quotes without emojis
            majesticCommitment.classList.remove('hidden');
            // Trigger reflow to restart animation
            void majesticCommitment.offsetWidth; 
            majesticCommitment.classList.add('visible');
            majesticCommitment.scrollIntoView({ behavior: 'smooth', block: 'center' });
        });
    });
    </script>
</body>
</html>
ÔøΩ
